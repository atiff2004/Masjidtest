{% extends 'finance/base.html' %}

{% block content %}
<div class="container">
    <h2 class="text-center text-white mb-4" style="font-size: 36px; font-weight: bold;">بیلنس چیک کریں</h2>
    <form method="GET" action="{% url 'check_balance' %}">
        <div class="row gy-3">
            <!-- Balance Type Selection -->
            <div class="col-md-4 col-12">
                <label for="balance_type" class="form-label" style="font-size: 24px; font-family: 'Jameel Noori Nastaleeq', sans-serif;">
                    :بیلنس کی قسم منتخب کریں
                </label>
                <select id="balance_type" name="balance_type" class="form-select" style="font-size: 22px; font-family: 'Jameel Noori Nastaleeq', sans-serif; direction: rtl;">
                    <option value="deposit" {% if balance_type == "deposit" %}selected{% endif %}> جمع رقم</option>
                    <option value="withdraw" {% if balance_type == "withdraw" %}selected{% endif %}> نکالی گئی رقم</option>
                    <option value="available_balance" {% if balance_type == "available_balance" %}selected{% endif %}> دستیاب بیلنس</option>
                </select>
            </div>

            <!-- Date Range Selection -->
            <div class="col-md-4 col-6">
                <label for="start_date" class="form-label" style="font-size: 24px; font-family: 'Jameel Noori Nastaleeq', sans-serif; direction: rtl;">
                    شروع کرنے کی تاریخ :
                </label>
                <input type="date" id="start_date" name="start_date" class="form-control" style="font-size: 18px; direction: rtl;" value="{{ start_date }}">
            </div>
            <div class="col-md-4 col-6">
                <label for="end_date" class="form-label" style="font-size: 24px; font-family: 'Jameel Noori Nastaleeq', sans-serif;">
                    :آخری تاریخ 
                </label>
                <input type="date" id="end_date" name="end_date" class="form-control" style="font-size: 18px; direction: rtl;" value="{{ end_date }}">
            </div>
        </div>

        <div class="text-center mt-4">
            <button type="submit" class="btn btn-primary px-4 py-2" style="font-size: 20px; font-family: 'Jameel Noori Nastaleeq', sans-serif;">
                چیک کریں
            </button>
        </div>
    </form>
</div>

<div class="container mt-4">
    <!-- Display Results -->
    {% if balance_type == 'available_balance' %}
    <div class="table-responsive">
        <table class="table table-bordered text-center" style="direction: rtl;">
            <thead class="table-dark">
                <tr>
                    <th style="font-size: 22px;">کل جمع رقم</th>
                    <th style="font-size: 22px;">کل نکالی گئی رقم</th>
                    <th style="font-size: 22px;">دستیاب بیلنس</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="font-size: 20px;">{{ deposit_total|floatformat:2 }}</td>
                    <td style="font-size: 20px;">{{ withdraw_total|floatformat:2 }}</td>
                    <td style="font-size: 20px;">{{ available_balance|floatformat:2 }}</td>
                </tr>
            </tbody>
        </table>
    </div>
    {% elif balance_type == 'deposit' or balance_type == 'withdraw' %}
    <div class="table-responsive">
        <table class="table table-bordered text-center" style="direction: rtl;">
            <thead class="table-dark">
                <tr>
                    <th style="font-size: 22px;">تاریخ</th>
                    <th style="font-size: 22px;">{% if balance_type == 'deposit' %} فنڈ کا نام {% else %} اخراجات کی قسم {% endif %}</th>
                    <th style="font-size: 22px;">رقم</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records %}
                <tr>
                    <td style="font-size: 20px;">{{ record.date }}</td>
                    <td style="font-size: 20px;">
                        {% if balance_type == 'deposit' %}
                            {{ record.fund.urdu_name }}
                        {% else %}
                            {{ record.expense_name }}
                        {% endif %}
                    </td>
                    <td style="font-size: 20px;">{{ record.amount|floatformat:2 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="mt-3 p-3 text-center bg-light" style="direction: rtl; border: 1px solid #ddd;">
        <h5 style="font-size: 20px; font-family: 'Jameel Noori Nastaleeq', sans-serif;">
            {% if balance_type == 'deposit' %}
                کل جمع رقم: {{ deposit_total }} روپے
            {% elif balance_type == 'withdraw' %}
                کل نکالی گئی رقم: {{ withdraw_total }} روپے
            {% endif %}
        </h5>
    </div>
    {% else %}
    <p class="text-center text-muted" style="font-size: 18px;">کوئی ریکارڈ دستیاب نہیں۔</p>
    {% endif %}
</div>
{% endblock %}
